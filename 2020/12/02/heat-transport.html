<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Lecture 5, Heat transports | florianboergel.github.io</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Lecture 5, Heat transports" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="personal code base" />
<meta property="og:description" content="personal code base" />
<link rel="canonical" href="https://florianboergel.github.io/personal_blog/2020/12/02/heat-transport.html" />
<meta property="og:url" content="https://florianboergel.github.io/personal_blog/2020/12/02/heat-transport.html" />
<meta property="og:site_name" content="florianboergel.github.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-02T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://florianboergel.github.io/personal_blog/2020/12/02/heat-transport.html","@type":"BlogPosting","headline":"Lecture 5, Heat transports","dateModified":"2020-12-02T00:00:00-06:00","datePublished":"2020-12-02T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://florianboergel.github.io/personal_blog/2020/12/02/heat-transport.html"},"description":"personal code base","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/personal_blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://florianboergel.github.io/personal_blog/feed.xml" title="florianboergel.github.io" /><link rel="shortcut icon" type="image/x-icon" href="/personal_blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/personal_blog/">florianboergel.github.io</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/personal_blog/about/">About Me</a><a class="page-link" href="/personal_blog/search/">Search</a><a class="page-link" href="/personal_blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Lecture 5, Heat transports</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-12-02T00:00:00-06:00" itemprop="datePublished">
        Dec 2, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      11 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/florianboergel/personal_blog/tree/master/_notebooks/2020-12-02-heat-transport.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/personal_blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/florianboergel/personal_blog/master?filepath=_notebooks%2F2020-12-02-heat-transport.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/personal_blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/florianboergel/personal_blog/blob/master/_notebooks/2020-12-02-heat-transport.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/personal_blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-12-02-heat-transport.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1)-Background:-two-dimensional-advection-diffusion">1) Background: two-dimensional advection-diffusion<a class="anchor-link" href="#1)-Background:-two-dimensional-advection-diffusion"> </a></h1><h2 id="1.1)-The-two-dimensional-advection-diffusion-equation">1.1) The two-dimensional advection-diffusion equation<a class="anchor-link" href="#1.1)-The-two-dimensional-advection-diffusion-equation"> </a></h2><p>Recall from <strong>Lecture 5</strong> that the one-dimensional advection-diffusion equation is written as</p>
<p>
$$\frac{\partial T(x,t)}{\partial t} = -U \frac{\partial T}{\partial x} + \kappa \frac{\partial^{2} T}{\partial x^{2}},$$
</p>
<p>where $T(x, t)$ is the temperature, $U$ is a constant advective velocity and $\kappa$ is the diffusivity.</p>
<p>The two-dimensional advection diffusion equation simply adds advection and diffusion operators acting in a second dimensions $y$ (orthogonal to $x$).</p>
<p>
$$\frac{\partial T(x,y,t)}{\partial t} = u(x,y) \frac{\partial T}{\partial x} + v(x,y) \frac{\partial T}{\partial y} + \kappa \left( \frac{\partial^{2} T}{\partial x^{2}} + \frac{\partial^{2} T}{\partial y^{2}} \right),$$
</p>
<p>where $\vec{u}(x,y) = (u, v) = u\,\mathbf{\hat{x}} + v\,\mathbf{\hat{y}}$ is a velocity vector field.</p>
<p>Throughout the rest of the Climate Modelling module, we will consider $x$ to be the <em>longitundinal</em> direction (positive from west to east) and $y$ to the be the <em>latitudinal</em> direction (positive from south to north).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.2)-Multivariable-shorthand-notation">1.2) Multivariable shorthand notation<a class="anchor-link" href="#1.2)-Multivariable-shorthand-notation"> </a></h2><p>Conventionally, the two-dimensional advection-diffusion equation is written more succintly as</p>
<p>
$$\frac{\partial T(x,y,t)}{\partial t} = - \vec{u} \cdot \nabla T + \kappa \nabla^{2} T,$$
</p>
<p>using the following shorthand notation.</p>
<p>The <strong>gradient</strong> operator is defined as</p>
<p>$\nabla \equiv (\frac{\partial}{\partial x}, \frac{\partial }{\partial y})$</p>
<p>such that</p>
<p>$\nabla T = (\frac{\partial T}{\partial x}, \frac{\partial T}{\partial y})$ and</p>
<p>$\vec{u} \cdot \nabla T = (u, v) \cdot (\frac{\partial T}{\partial x}, \frac{\partial T}{\partial y}) = u \frac{\partial T}{\partial x} + v\frac{\partial T}{\partial y}.$</p>
<p>The <strong>Laplacian</strong> operator $\nabla^{2}$ (sometimes denoted $\Delta$) is defined as</p>
<p>$\nabla^{2} = \frac{\partial^{2}}{\partial x^{2}} + \frac{\partial^{2}}{\partial y^{2}}$</p>
<p>such that</p>
<p>$\nabla^{2} T = \frac{\partial^{2} T}{\partial x^{2}} + \frac{\partial^{2} T}{\partial y^{2}}.$</p>
<p>The <strong>divergence</strong> operator is defined as $\nabla \cdot [\quad]$, such that</p>
<p>$\nabla \cdot \vec{u} = \left(\frac{\partial}{\partial x}, \frac{\partial}{\partial x} \right) \cdot (u,v) = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}.$</p>
<p><strong>Note:</strong> Since seawater is largely incompressible, we can approximate ocean currents as a <em>non-divergent flow</em>, with $\nabla \cdot \vec{u} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = 0$. Among other implications, this allows us to write:</p>
\begin{align}
\vec{u} \cdot \nabla T&amp;=
u\frac{\partial T(x,y,t)}{\partial x} + v\frac{\partial T(x,y,t)}{\partial y}\newline &amp;=
u\frac{\partial T}{\partial x} + v\frac{\partial T}{\partial y} + T\left(\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}\right)\newline &amp;=
\left( u\frac{\partial T}{\partial x} + T\frac{\partial u}{\partial x} \right) +
\left( v\frac{\partial T}{\partial y} + \frac{\partial v}{\partial y} \right)
\newline &amp;=
\frac{\partial (uT)}{\partial x} + \frac{\partial (vT)}{\partial x}\newline &amp;=
\nabla \cdot (\vec{u}T)
\end{align}<p>using the product rule (separately in both $x$ and $y$).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="1.3)-The-flux-form-two-dimensional-advection-diffusion-equation">1.3) The flux-form two-dimensional advection-diffusion equation<a class="anchor-link" href="#1.3)-The-flux-form-two-dimensional-advection-diffusion-equation"> </a></h5><p>This lets us finally re-write the two-dimensional advection-diffusion equation as:</p>
<p>$\frac{\partial T}{\partial t} = - \nabla \cdot (\vec{u}T) + \kappa \nabla^{2} T$</p>
<p>which is the form we will use in our numerical algorithm below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2)-Numerical-implementation">2) Numerical implementation<a class="anchor-link" href="#2)-Numerical-implementation"> </a></h1><h1 id="2.1)-Discretizing-advection-in-two-dimensions">2.1) Discretizing advection in two dimensions<a class="anchor-link" href="#2.1)-Discretizing-advection-in-two-dimensions"> </a></h1><p>In Lecture XX we saw that in one dimension we can discretize a first-partial derivative in space using the <em>centered finite difference</em></p>
<p>
$$\frac{\partial T(x_{i}, t_{n})}{\partial x} \approx \frac{T_{i+1}^{n} - T_{i-1}^{n}}{2 \Delta x}.$$
</p>
<p>In two dimensions, we discretize the partial derivative the exact same way, except that we also need to keep track of the cell index $j$ in the $y$ dimension:</p>
<p>
$$\frac{\partial T(x_{i}, y_{j}, t_{n})}{\partial x} \approx \frac{T_{i+1,\, j}^{n} - T_{i-1,\,j}^{n}}{2 \Delta x}.$$
</p>
<p>The <em>x-gradient kernel</em> below, implemented using the <code>OffsetArray</code> type, is shown below, and is reminiscent of the <em>edge-detection</em> or <em>sharpening</em> kernels used in image processing and machine learning:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWAAAACPCAYAAADEBAGvAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAADx0lEQVR4nO3cP4vcVRzF4fM1IYgEKwPiXyzEmEpBrC2jhbb6GgSxsLCzsrOwSaFgsNPalyAEiwS00EIIwmoQjIuF2BjBa5EtYkixszE5TuZ5YIq5THHgsh+GH7s7a60AcPfd1x4AsKsEGKBEgAFKBBigRIABSgQYoOT4Jh+e4/evOXHyTm3hDnv+9BPtCRzRj19/157AbdjPtf211qmbzzcL8ImTOf7Mq//dKu6qCxfOtSdwRG8/8Gx7Arfho+zt3ercIwiAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKBFggBIBBigRYIASAQYoEWCAEgEGKJm11uE/PPNrkr07N6fuoST77REcibvbbvf6/T251jp18+FGAb7XzcyltdYL7R1szt1tt129P48gAEoEGKBEgP/t4/YAjszdbbedvD/PgAFKfAMGKBHgJDNzema+mpk/Z+ad9h42MzNnZ+b7mbk8M++293B4M3N+Zq7OzLftLQ0CfN1vSd5K8kF7CJuZmWNJziV5OcmZJG/MzJnuKjbwaZKz7REtApxkrXV1rXUxyV/tLWzsxSSX11o/rLWuJfk8yWvlTRzSWuvLXP8CtJMEmG33aJKfbnh/5eAM/vcEmG03tzjzqz1shZ0N8My8OTPfHLweae/hyK4kefyG948l+bm0BTayswFea51baz138PIDu70uJnl6Zp6amRNJXk/yRXkTHIo/xEgyMw8nuZTkwSR/J/kjyZm11u/VYRzKzLyS5MMkx5KcX2u9X57EIc3MZ0leyvX/hvZLkvfWWp9UR91FAgxQsrOPIADaBBigRIABSgQYoESAAUoEGKBEgAFKBBig5B9AxYSNvAxKZgAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first-order partial derivative in $y$ is similarly discretized as:</p>
<p>
$$\frac{\partial T(x_{i}, y_{j}, t_{n})}{\partial y} \approx \frac{T_{i,\, j+1}^{n} - T_{i,\,j-1}^{n}}{2 \Delta y}.$$
</p>
<p>Its kernel is shown below.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAADrCAYAAADJ/hxqAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAExUlEQVR4nO3dv8uVdRjH8etKC7GsRaEfRjRE4SgPDf0FNhW05Bw8ixENDf0jDjlIW80NQmsgDhk4FBRIYEmEPTi0ZdHV4iD1mOd+fO7kY68XnOGc+3C+1/Dmy5dz4Nw9MwWpHnnQA8D9EDDRBEw0ARNNwEQTMNEOrr3AoT4wR9ZfhofYTt3amZlju11bvawjdbDeqmfWXoaH2Ed17drdrjlCEE3ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEWxxwd5/v7hvd/fUaA8ESe9mBP66qU/s8B+zJ4oBn5ouqurnCLLCYMzDRVrnFQHdvV9V2VdUTdWCNJaCqVtqBZ+bczGzNzNYhAbMiRwii7eVrtE+q6lJVvdzd17v7nf0fCzaz+Aw8M6fXGAT2whGCaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagInWM7PqAidPnpyLFy+uugYPt8OHD381M1u7XbMDE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEy0xQF396nu/q67r3b3h2sMBZtaFHB3H6iqs1X1elWdqKrT3X1ijcFgE0t34Fer6urMfD8zt6rq06p6Y//Hgs0sDfi5qvrxjufXb78GD8TSgHuX1/5xl5ju3u7uy919eWdnZ2+TwQaWBny9qp6/4/nxqvrp72+amXMzszUzW0ePHr2f+eBfLQ34y6p6qbtf7O7Hqurtqvps/8eCzRxc8uaZ+aO7362qz6vqQFWdn5lvVpkMNrAo4KqqmblQVRdWmAUW80sc0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEy0xX+vutSVb3+op147s/Yy/E/ZgYkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAIm2qKAu/uV7r7U3b919wdrDQWbWvoP7Ter6r2qenOFWWCxRTvwzNyYmS+r6veV5oFFnIGJtspNXrp7u6q2q6rq0cfXWAKqaoMduLvPdPeV249nN/nQmTk3M1szs9UHD93/lHAX99yBZ+ZsVZ39D2aBxRYdIbr76aq6XFVPVtWf3f1+VZ2YmV/XGA7uZVHAM/NzVR1faRZYzLcQRBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEy0npl1F+j+paqurboID7sXZubYbhdWDxjW5AhBNAETTcBEEzDRBEw0ARNNwEQTMNEETLS/ALHkm5v9uiwzAAAAAElFTkSuQmCC
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have discretized the two derivate terms, we can write out the <em>advective tendency</em> for computing $T_{i, j, n+1}$ as</p>
<p>
$$u\frac{\partial T}{\partial x} + v\frac{\partial T}{\partial y} \approx u_{i,\, j}^{n} \frac{T_{i,\, j+1}^{n} - T_{i,\,j-1}^{n}}{2 \Delta y} + v_{i,\, j}^{n} \frac{T_{i,\, j+1}^{n} - T_{i,\,j-1}^{n}}{2 \Delta y}.$$
</p>
<p>We implement this in julia as a series of methods for the <code>advect</code> function. The first method computes the advective tendency (as a single <code>Float64</code> type) for the $(i,j)$ grid cell while the second method returns an array of the tendencies for each grid cell using two nested for loops.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xkernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">xkernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ykernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ykernel</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">OceanModel</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">deltay</span><span class="p">,</span> <span class="n">deltax</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltay</span> <span class="o">=</span> <span class="n">deltay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltax</span> <span class="o">=</span> <span class="n">deltax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">advect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">deltay</span><span class="p">,</span> <span class="n">deltax</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="n">T_advect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_advect</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_advect</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">T_advect</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xkernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">deltax</span><span class="p">)</span> <span class="o">+</span> \
                                   <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ykernel</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">deltax</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.3)-No-flux-boundary-conditions">2.3) No-flux boundary conditions<a class="anchor-link" href="#2.3)-No-flux-boundary-conditions"> </a></h2><p>We want to impose the no-flux boundary conditions, which states that</p>
$$u\frac{\partial T}{\partial x} = \kappa \frac{\partial T}{\partial x} = 0$$<p>at $x$ boundaries and</p>
$$v\frac{\partial T}{\partial y} = \kappa \frac{\partial T}{\partial y} = 0$$<p>at the $y$ boundaries.</p>
<p>To impose this, we treat $i=1$ and $i=N_{x}$ as <em>ghost cells</em>, which do not do anything expect help us impose these boundaries conditions. Discretely, the boundary fluxes between $i=1$ and $i=2$ vanish if</p>
$$\dfrac{T_{2,\,j}^{n} -T_{1,\,j}^{n}}{\Delta x} = 0$$<p>or</p>
<p>
$$T_{1,\,j}^{n} = T_{2,\,j}^{n}.$$
</p>
<p>Thus, we can implement the boundary conditions by updating the temperature of the ghost cells to match their interior-point neighbors:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.2)-Discretizing-diffusion-in-two-dimensions">2.2) Discretizing diffusion in two dimensions<a class="anchor-link" href="#2.2)-Discretizing-diffusion-in-two-dimensions"> </a></h2><p>Just as with advection, the process for discretizing the diffusion operators effectively consists of repeating the one-dimensional process for $x$ in a second dimension $y$, separately:</p>
$$\kappa \left( \frac{\partial^{2} T}{\partial x^{2}} + \frac{\partial^{2} T}{\partial y^{2}} \right) = \kappa \left(
\frac{T_{i+1,\;j}^{n} - 2T_{i,\;j}^{n} + T_{i-1,\;j}^{n}}{\left( \Delta x \right)^{2}} +
\frac{T_{i,\;j+1}^{n} - 2T_{i,\;j}^{n} + T_{i,\;j-1}^{n}}{\left( \Delta y \right)^{2}}
\right)$$<p>The corresponding $x$ and $y$ second-derivative kernels are shown below:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAADrCAYAAADJ/hxqAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAEXUlEQVR4nO3dMWueZRTH4XNMhYiNixRUBMeKcz6BU0ehU+dCFkEc/CodmqF267dw6NJBhwz9AoEOUmsGHUQFj4tDh8bmeZtb+YfrgkwPvPcZftwcniFPz0xBqrf+7wHgTQiYaAImmoCJJmCiCZho11YfsN97c7D+GK6wF/XHi5m58apny8s6qGt1uz5cfQxX2P06PT3vmRWCaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiba5oC7+0F3P+/upysGgi12uYEfVtWtS54DdrI54Jl5XFVnC2aBzezARFvyiYHuPqqqo6qq67W34gioqkU38Mwcz8zhzBzuC5iFrBBE2+U12qOqelJVN7v7WXffvfyx4GI278Azc2fFILALKwTRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE23JNzJe9vM7B/Xg5uerj+EqO/n23EduYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJting7v60u5909+/d/c2qoeCitv6H9rOq+qqqvlgwC2y26Qaemecz831V/bloHtjEDky0JR956e6jqjqqqqq3311xBFTVBW7g7v6yu0/++fvoIj86M8czczgzh31t/82nhHO89gaemXtVde8/mAU227RCdPcHVfVDVb1XVX9199dV9dnM/LJiOHidTQHPzI9V9fGiWWAzbyGIJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIt+cTAy97/7de6ffLd6mO4wu7/yzM3MNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBEEzDRBEw0ARNNwEQTMNEETDQBE03ARBMw0QRMNAETTcBE2xxwdz/o7ufd/XTFQLDFLjfww6q6dclzwE42Bzwzj6vqbMEssJkdmGhLPvLS3UdVdVRVdb32VhwBVbXoBp6Z45k5nJnDfQGzkBWCaLu8RntUVU+q6mZ3P+vuu5c/FlzM5h14Zu6sGAR2YYUgmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKIJmGgCJpqAiSZgogmYaAImmoCJJmCiCZhoAiaagIkmYKL1zKw9oPunqjpdeghX3Sczc+NVD5YHDCtZIYgmYKIJmGgCJpqAiSZgogmYaAImmoCJ9jftxXxWHGmSKwAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWAAAACPCAYAAADEBAGvAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAADTElEQVR4nO3bIa5cZRyH4e8PV4AoBpoABlkWwApQ+C4BSYIgSJaArQDR1LELBKYCRAUbaFJVLhgEAcSHoIaGhM5c6MvteZ5kzMlM8ku+nDcnJ5nZey8Anr+X6gEARyXAABEBBogIMEBEgAEiAgwQuTjly6/My/vGaT/hf+THV2/UEzjT67/8XE/gCi7Xb5d775tPXz+ppjfWxbq93vr3VvFc3b31fj2BM91+8HU9gSv4Yj18+HfXvYIAiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEBBggIsAAEQEGiAgwQESAASICDBARYICIAANEZu/97F+e+WGt9fC/m5N7Y611WY/gLM7uenvRz++dvffNpy+eFOAX3cx8t/d+r97B6Zzd9XbU8/MKAiAiwAARAf6rL+sBnM3ZXW+HPD/vgAEinoABIocP8MzcnZnHM/N9vYXzzMy7M3N/Zn6dmU/rPTy7o99/hw/wWuveWuuDegRX8tNa6+O11uf1EE52bx34/jt8gPfe36w/b2Cuqb334733t2ut3+stnObo99/hAwxQEWCAiABzLc3MRzPz4Mnn7XoPnOOiHgDn2HvfWWvdqXfAVRz+CXhmvlpr3V9r3ZqZRzPzYb2J08zMmzPzaK31yVrrsyfn+Fq9i3929PvPP+EAIod/AgaoCDBARIABIgIMEBFggIgAA0QEGCAiwACRPwBjpGGXc+bMZQAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as we did with advection, we implement a diffuse function using multiple dispatch:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xkernel_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">xkernel_diff</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ykernel_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ykernel_diff</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">OceanModel</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">deltay</span><span class="p">,</span> <span class="n">deltax</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltay</span> <span class="o">=</span> <span class="n">deltay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltax</span> <span class="o">=</span> <span class="n">deltax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">advect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">deltay</span><span class="p">,</span> <span class="n">deltax</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="n">T_advect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">T_advect</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">T_advect</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">T_advect</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xkernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">deltax</span><span class="p">)</span> <span class="o">+</span> \
                                   <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ykernel</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">deltax</span><span class="p">))</span>
                
    <span class="k">def</span> <span class="nf">diffuse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">T_diffuse</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]):</span>
                <span class="n">T_diffuse</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xkernel_diff</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                                    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ykernel_diff</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.3)-No-flux-boundary-conditions">2.3) No-flux boundary conditions<a class="anchor-link" href="#2.3)-No-flux-boundary-conditions"> </a></h2><p>We want to impose the no-flux boundary conditions, which states that</p>
$$u\frac{\partial T}{\partial x} = \kappa \frac{\partial T}{\partial x} = 0$$<p>at $x$ boundaries and</p>
$$v\frac{\partial T}{\partial y} = \kappa \frac{\partial T}{\partial y} = 0$$<p>at the $y$ boundaries.</p>
<p>To impose this, we treat $i=1$ and $i=N_{x}$ as <em>ghost cells</em>, which do not do anything expect help us impose these boundaries conditions. Discretely, the boundary fluxes between $i=1$ and $i=2$ vanish if</p>
$$\dfrac{T_{2,\,j}^{n} -T_{1,\,j}^{n}}{\Delta x} = 0$$<p>or</p>
<p>
$$T_{1,\,j}^{n} = T_{2,\,j}^{n}.$$
</p>
<p>Thus, we can implement the boundary conditions by updating the temperature of the ghost cells to match their interior-point neighbors:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">update_ghostcells</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;no-flux&quot;</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;no-flux&quot;</span><span class="p">:</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> 
        <span class="n">A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">A</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.colorbar.Colorbar at 0x7fe8fe80a8b0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">update_ghostcells</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.colorbar.Colorbar at 0x7fe8fe7b45b0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.4)-Timestepping">2.4) Timestepping<a class="anchor-link" href="#2.4)-Timestepping"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">OceanModel</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">deltat</span><span class="p">,</span> <span class="n">windfield</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">kappa</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">windfield</span><span class="o">.</span><span class="n">u</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">windfield</span><span class="o">.</span><span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltay</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">deltay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltax</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">deltax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span> <span class="o">=</span> <span class="n">deltat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="n">kappa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diffuse_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advect_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">advect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">T_advect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_advect</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_advect</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">T_advect</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xkernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="p">)</span> <span class="o">+</span> \
                                   <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ykernel</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">T_advect</span>
                
    <span class="k">def</span> <span class="nf">diffuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">T_diffuse</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_diffuse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_diffuse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">T_diffuse</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xkernel_diff</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                                              <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ykernel_diff</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>      
        <span class="k">return</span> <span class="n">T_diffuse</span>
        
    <span class="k">def</span> <span class="nf">timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">T_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">T_</span> <span class="o">=</span> <span class="n">update_ghostcells</span><span class="p">(</span><span class="n">T_</span><span class="p">)</span>
            <span class="n">tendencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">advect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffuse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diffuse_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffuse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advect_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">advect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">T_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span> <span class="o">*</span> <span class="n">tendencies</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">T_</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltat</span><span class="p">)</span>    
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">grid</span><span class="p">:</span>   
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltax</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deltay</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltax</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">deltay</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">deltay</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltay</span><span class="p">)</span>   

        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">windfield</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;zero&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;zero&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;single_gyre&quot;</span><span class="p">:</span>
            <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">PointVortex</span><span class="p">(</span><span class="n">my_grid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
            
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">6e6</span><span class="p">)</span>
<span class="n">my_wind</span> <span class="o">=</span> <span class="n">windfield</span><span class="p">(</span><span class="n">my_grid</span><span class="p">)</span>
<span class="n">my_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">my_grid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> 
<span class="n">my_temp</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">my_temp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Kilometers Latitude&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;Kilometers Latitude&#39;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deltat</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span> <span class="c1"># 12 Hourse</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_model</span> <span class="o">=</span> <span class="n">OceanModel</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">my_temp</span><span class="p">,</span>
                      <span class="n">deltat</span><span class="o">=</span><span class="n">deltat</span><span class="p">,</span> 
                      <span class="n">windfield</span><span class="o">=</span><span class="n">my_wind</span><span class="p">,</span> 
                      <span class="n">grid</span><span class="o">=</span><span class="n">my_grid</span><span class="p">,</span> 
                      <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_func</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
    <span class="n">my_model</span> <span class="o">=</span> <span class="n">OceanModel</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">my_temp</span><span class="p">,</span>
                      <span class="n">deltat</span><span class="o">=</span><span class="n">deltat</span><span class="p">,</span> 
                      <span class="n">windfield</span><span class="o">=</span><span class="n">my_wind</span><span class="p">,</span> 
                      <span class="n">grid</span><span class="o">=</span><span class="n">my_grid</span><span class="p">,</span> 
                      <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">my_model</span><span class="o">.</span><span class="n">timestep</span><span class="p">()</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_func</span><span class="p">,</span> 
         <span class="n">my_model</span> <span class="o">=</span> <span class="n">fixed</span><span class="p">(</span><span class="n">my_model</span><span class="p">),</span>
         <span class="n">steps</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Timesteps&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_func</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
    <span class="n">my_model</span> <span class="o">=</span> <span class="n">OceanModel</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">my_temp</span><span class="p">,</span>
                      <span class="n">deltat</span><span class="o">=</span><span class="n">deltat</span><span class="p">,</span> 
                      <span class="n">windfield</span><span class="o">=</span><span class="n">my_wind</span><span class="p">,</span> 
                      <span class="n">grid</span><span class="o">=</span><span class="n">my_grid</span><span class="p">,</span> 
                      <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">my_model</span><span class="o">.</span><span class="n">timestep</span><span class="p">()</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">my_model</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_func</span><span class="p">,</span> 
         <span class="n">my_model</span> <span class="o">=</span> <span class="n">fixed</span><span class="p">(</span><span class="n">my_model</span><span class="p">),</span>
         <span class="n">steps</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Timesteps&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">diagnose_velocities</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">G</span><span class="p">):</span>

    
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">G</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">G</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    
    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">stream</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">stream</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">G</span><span class="o">.</span><span class="n">deltax</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">/</span><span class="n">G</span><span class="o">.</span><span class="n">deltay</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">G</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">G</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">dy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dx</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">dx</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
    
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">impose_no_flux</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">v</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">u</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">v</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">PointVortex</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">deltax</span><span class="o">/</span><span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">deltax</span> <span class="o">/</span> <span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">deltax</span> <span class="o">/</span> <span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">deltay</span><span class="o">/</span><span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">deltay</span> <span class="o">/</span> <span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">deltay</span> <span class="o">/</span> <span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    
    
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="o">-</span><span class="n">omega</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> 
    <span class="n">stream</span><span class="p">[</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span>  <span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">))</span>
    
    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span>  <span class="n">diagnose_velocities</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="c1">#     u = (0.1/1e3)/(2e-11*G.L*1000) * u; v = (0.1/1e3)/(2e-11*G.L*1000) * v</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">impose_no_flux</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> 
    <span class="n">u</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">L</span><span class="p">;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">L</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="mf">0.1</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2e-11</span><span class="o">*</span><span class="mf">6000000.0</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0008333333333333334</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_wind</span> <span class="o">=</span> <span class="n">windfield</span><span class="p">(</span><span class="n">my_grid</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;single_gyre&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">my_wind</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.colorbar.Colorbar at 0x7fe8fe964730&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">my_grid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> 
<span class="n">my_temp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_model</span> <span class="o">=</span> <span class="n">OceanModel</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">my_temp</span><span class="p">,</span>
                      <span class="n">deltat</span><span class="o">=</span><span class="n">deltat</span><span class="p">,</span> 
                      <span class="n">windfield</span><span class="o">=</span><span class="n">my_wind</span><span class="p">,</span> 
                      <span class="n">grid</span><span class="o">=</span><span class="n">my_grid</span><span class="p">,</span> 
                      <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">timestep</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">advect_out</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.colorbar.Colorbar at 0x7fe8fe337130&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_func</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
    <span class="n">my_model</span> <span class="o">=</span> <span class="n">OceanModel</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">my_temp</span><span class="p">,</span>
                      <span class="n">deltat</span><span class="o">=</span><span class="n">deltat</span><span class="p">,</span> 
                      <span class="n">windfield</span><span class="o">=</span><span class="n">my_wind</span><span class="p">,</span> 
                      <span class="n">grid</span><span class="o">=</span><span class="n">my_grid</span><span class="p">,</span> 
                      <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">my_model</span><span class="o">.</span><span class="n">timestep</span><span class="p">()</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">my_wind</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">my_wind</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_wind</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<span class="n">my_wind</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span>
<span class="n">my_grid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(21, 11)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_func</span><span class="p">,</span> 
         <span class="n">my_model</span> <span class="o">=</span> <span class="n">fixed</span><span class="p">(</span><span class="n">my_model</span><span class="p">),</span>
         <span class="n">steps</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Timesteps&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">PointVortex</span><span class="p">(</span><span class="n">my_grid</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_grid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(21, 11)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 11)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">xpsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">deltax</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">deltax</span><span class="p">,</span> <span class="n">deltax</span><span class="p">)</span>
<span class="n">ypsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">deltay</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">deltay</span><span class="p">,</span> <span class="n">deltay</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">psihat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">np</span><span class="o">.</span><span class="n">psi</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-40-9a1e6cb481da&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> epsilon <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">0.05</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>xpsi <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>arange<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span>deltax<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">+</span>deltax<span class="ansi-blue-fg">,</span> deltax<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> ypsi <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>arange<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">-</span>deltay<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">+</span>deltay<span class="ansi-blue-fg">,</span> deltay<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> 
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-green-fg">def</span> psihat<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">NameError</span>: name &#39;deltax&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ypsi</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xpsi</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ypsi</span><span class="p">):</span>
        <span class="n">psi</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)))</span><span class="o">+</span><span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">epsilon</span><span class="p">))</span>
        
        
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)))</span><span class="o">+</span><span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">epsilon</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/personal_blog/2020/12/02/heat-transport.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/personal_blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/personal_blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/personal_blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>personal code base</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/florianboergel" title="florianboergel"><svg class="svg-icon grey"><use xlink:href="/personal_blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/climateflo" title="climateflo"><svg class="svg-icon grey"><use xlink:href="/personal_blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
